model_state_tensor_sizes = [
    31260672, 524288, 2048, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 
    1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 
    1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 
    1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 
    1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 
    4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 
    1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 
    1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 
    1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 
    1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 
    4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 
    1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 
    1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 
    1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 
    1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 
    1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 
    1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 
    1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 
    1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 
    1024, 1024, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1048576, 1024, 1024, 1024, 4194304, 4096, 4194304, 1024, 1024, 1024, 1048576, 
    1024, 30528, 1048576, 1024, 1024, 1024, 31260672, 2048, 2
]

optimizer_state_tensor_sizes = [
    31260672, 31260672, 524288, 524288, 2048, 2048, 1048576, 1048576, 
    1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 
    4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 
    1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 
    1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 
    4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 
    1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 
    1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 
    4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 
    1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 
    1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 
    4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 
    1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 
    1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 
    4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 
    1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 
    1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 
    4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 
    1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 
    1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 
    4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 
    1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 
    1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 
    4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 
    1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 
    1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 
    1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 
    4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 
    1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 
    1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 
    4194304, 4194304, 4194304, 4194304, 1048576, 1048576, 1048576, 1048576, 2048, 2048, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 
    1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 
    1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 
    1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 
    1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 
    1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 
    1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 
    1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 
    1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 
    4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 
    4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 
    1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 
    1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 4096, 4096, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 30528, 30528, 1024, 1024, 1024, 1024, 1024, 1024, 2, 2
]

print(len(model_state_tensor_sizes))
print(len(optimizer_state_tensor_sizes))

tensor_sizes_sum = sum(model_state_tensor_sizes)

print(tensor_sizes_sum)

num_splits = 2
size_per_split = tensor_sizes_sum // num_splits

print(size_per_split)

prev_split = 0
cum_size = 0

for idx, tensor_size in enumerate(model_state_tensor_sizes):
    cum_size += tensor_size
    if cum_size >= size_per_split:
        split = idx
        print("Split at: ", idx, cum_size, sum(model_state_tensor_sizes[prev_split:split + 1]))
        prev_split = split + 1
        cum_size = 0
print(sum(model_state_tensor_sizes[prev_split:]))
